generator client {
  provider        = "prisma-client-js"
  output          = "../src/generated/prisma"
  previewFeatures = ["driverAdapters"]
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model user {
  id            Int      @id @default(autoincrement())
  email         String   @unique
  password      String
  name          String
  emailVerified Boolean  @default(false)
  createdAt     DateTime @default(now())

  mailTokens mailToken[]
  organizationUsers organizationUser[]

  @@map("users")
}

model organization {
  id   Int    @id @default(autoincrement())
  name String

  events event[]
  organizationUsers organizationUser[]

  @@map("organizations")
}

model event {
  id           Int      @id @default(autoincrement())
  name         String
  organizationId Int

  organization organization @relation(fields: [organizationId], references: [id])

  @@map("events")
}

model organizationUser {
  id             Int           @id @default(autoincrement())
  organizationId Int
  userId         Int
  role           UserRoleTypes

  organization organization @relation(fields: [organizationId], references: [id])
  user         user         @relation(fields: [userId], references: [id])

  @@map("organization_users")
}

enum UserRoleTypes {
  User
  EventOwner
  SystemAdmin
}

model mailToken {
  id        Int            @id @default(autoincrement())
  userId    Int
  type      MailTokenTypes
  token     String         @unique
  createdAt DateTime       @default(now())
  expiredAt DateTime       @default(now())

  user user @relation(fields: [userId], references: [id])

  @@map("mail_tokens")
}

enum MailTokenTypes {
  EmailVerify
  PasswordReset
}
